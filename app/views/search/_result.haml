%hr{:style => 'margin: 9px 0;'}

.row-fluid
  .span2.half
    %a.thumbnail{:href => url_for(:resource, :index, :id => result.id)}
      = partial 'resource/image', :object => result

  .span10
    %a{:href => url_for(:resource, :index, :id => result.id)}
      %h4
        = result.heading.first.truncate(100, :separator => ' ')
        -#%small (#{result._score})
    -#= result._explanation.to_json

    - item = Resource.normalize(result.to_hash.except(:bibo), {:ids => :resolve})

    - agents = []
    - if !item[:dcterms][:creator].nil?
      - item[:dcterms][:creator].take(3).each do |creator|
        - if creator.is_a? Hash
          - heading = creator.keys.first.to_s.classify.constantize.find(creator.values.first).heading
          - agents << link_to(heading.first, url_for(creator.keys.first, :index, :id => creator.values.first))
    - elsif !item[:dcterms][:contributor].nil?
      - item[:dcterms][:contributor].take(3).each do |creator|
        - if creator.is_a? Hash
          - heading = creator.keys.first.to_s.classify.constantize.find(creator.values.first).heading
          - agents << link_to(heading.first, url_for(creator.keys.first, :index, :id => creator.values.first))
    - elsif !item[:dcterms][:publisher].nil?
      - item[:dcterms][:publisher].take(3).each do |creator|
        - if creator.is_a? Hash
          - heading = creator.keys.first.to_s.classify.constantize.find(creator.values.first).heading
          - agents << link_to(heading.first, url_for(creator.keys.first, :index, :id => creator.values.first))

    - desc = []
    - desc.push item[:dcterms][:format].first.capitalize rescue nil
    - desc.push item[:dcterms][:issued].first rescue nil
    - desc.push ISO_639.find(item[:dcterms][:language].first).english_name.capitalize rescue nil

    .description #{[agents + desc].join('; ')}